#!/bin/bash

# --- Configuration ---
TARGET_DIR="$1"
# ---------------------

# Function to display usage information
usage() {
    echo "Usage: $0 <directory_path>"
    echo "Checks if the specified directory is completely empty (no files, no hidden files, no subdirectories)."
    exit 1
}

# 1. Check if a directory path was provided
if [ -z "$TARGET_DIR" ]; then
    echo "Error: Directory path not provided."
    usage
fi

# 2. Check if the path exists and is a directory
if [ -e "$TARGET_DIR" ]; then
    if [ ! -d "$TARGET_DIR" ]; then
        echo "Error: Directory '$TARGET_DIR' does not exist or is not a directory."
        exit 1
    fi
fi


# 3. Use 'find' to check for any contents, including hidden files
# The '-mindepth 1' ensures we only look at content *inside* the directory,
# ignoring the directory itself (which is always found).
# The '-print -quit' stops immediately upon finding the first item for efficiency.
find_result=$(find "$TARGET_DIR" -mindepth 1 -print -quit 2>/dev/null)

if [ -z "$find_result" ]; then
    exit 0
else
    # To be more helpful, list the first item found
    echo "Validation Failed: Directory '$TARGET_DIR' is NOT empty."
    echo "Found content starting with: $find_result"
    exit 1
fi
